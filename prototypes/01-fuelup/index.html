<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FuelUp ‚Äî Streak Partners Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet">
    <link rel="stylesheet" href="/src/style.css">
</head>
<body class="max-w-md mx-auto min-h-screen pb-28 relative font-sans">

<!-- Toast Notification -->
<div class="fixed bottom-24 left-1/2 -translate-x-1/2 z-[100] w-full max-w-[94%] pointer-events-none" id="toast-container"></div>

<div id="app">
    <!-- DASHBOARD: STREAK PARTNERS FOCUS -->
    <section class="animate-in fade-in duration-500" id="view-dashboard">
        <header class="p-5 space-y-5">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-brown-90 text-white rounded-full flex items-center justify-center font-black" id="current-user-avatar">D</div>
                    <div>
                        <h1 class="font-heading text-xl font-extrabold text-brown-90 leading-tight" id="active-user-name">Duy</h1>
                        <p class="text-[10px] font-bold text-orange-secondary uppercase tracking-widest">Shared Streak Active</p>
                    </div>
                </div>
                <button class="p-2 rounded-full bg-white shadow-sm border border-gray-100" onclick="navigate('settings')">
                    <span class="material-symbols-outlined text-gray-60">settings</span>
                </button>
            </div>

            <!-- THE SHARED STREAK HERO CARD -->
            <div class="bg-brown-90 rounded-2xl-24 p-6 text-white shadow-2xl relative overflow-hidden">
                <!-- Background Fire Icon Decoration -->
                <div class="absolute -right-6 -bottom-6 opacity-10">
                    <span class="material-symbols-outlined text-[10rem] animate-fire">local_fire_department</span>
                </div>

                <div class="relative z-10 flex flex-col items-center gap-2">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="material-symbols-outlined text-streak-fire animate-fire">local_fire_department</span>
                        <span class="text-xs font-black tracking-widest uppercase opacity-70">Shared Streak</span>
                    </div>
                    <div class="text-6xl font-black font-heading tracking-tighter" id="streak-counter">12</div>
                    <div class="text-[10px] font-bold uppercase tracking-[0.2em] opacity-60">Days Together</div>

                    <div class="w-full grid grid-cols-2 gap-4 mt-6">
                        <!-- My Progress -->
                        <div class="bg-white/10 p-3 rounded-2xl border border-white/5 flex flex-col items-center gap-2">
                            <div class="w-8 h-8 rounded-full border-2 border-white/20 flex items-center justify-center font-black text-xs" id="me-indicator-icon">D</div>
                            <div class="text-[10px] font-black uppercase" id="me-indicator-label">Duy</div>
                            <div class="w-2 h-2 rounded-full bg-red-400" id="me-status-dot"></div>
                        </div>
                        <!-- Partner Progress -->
                        <div class="bg-white/10 p-3 rounded-2xl border border-white/5 flex flex-col items-center gap-2">
                            <div class="w-8 h-8 rounded-full border-2 border-white/20 flex items-center justify-center font-black text-xs bg-orange-secondary" id="partner-indicator-icon">A</div>
                            <div class="text-[10px] font-black uppercase" id="partner-indicator-label">Anh</div>
                            <div class="w-2 h-2 rounded-full bg-green-primary shadow-[0_0_8px_rgba(120,157,138,0.8)]" id="partner-status-dot"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Daily Calorie Overview -->
            <div class="bg-white rounded-2xl-24 p-5 shadow-sm border border-gray-100 flex items-center gap-4">
                <div class="relative w-16 h-16 flex items-center justify-center">
                    <svg class="w-full h-full">
                        <circle cx="32" cy="32" fill="transparent" r="28" stroke="#F1F1F1" stroke-width="6"></circle>
                        <circle class="progress-ring-circle" cx="32" cy="32" fill="transparent" id="main-progress-ring" r="28" stroke="#789D8A" stroke-dasharray="175.93" stroke-dashoffset="175.93" stroke-linecap="round" stroke-width="6"></circle>
                    </svg>
                    <span class="absolute text-xs font-black" id="display-remaining">2200</span>
                </div>
                <div class="flex-1">
                    <div class="text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1">Your Fuel Goal</div>
                    <p class="text-xs font-bold text-brown-neutral" id="status-text">One of you still needs to log fuel!</p>
                </div>
            </div>
        </header>

        <main class="px-5 pb-12 space-y-6">
            <!-- PARTNER WARNING -->
            <div class="hidden animate-in fade-in slide-in-from-top duration-700" id="partner-nudge-card">
                <div class="bg-orange-secondary/10 border border-orange-secondary/20 p-4 rounded-2xl flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-orange-secondary animate-pulse">warning</span>
                        <div>
                            <p class="text-[11px] font-black text-brown-90 uppercase tracking-tight" id="nudge-text">Don't let Anh down!</p>
                            <p class="text-[9px] font-bold text-gray-400">Streak breaks in 4 hours if she doesn't log.</p>
                        </div>
                    </div>
                    <button class="bg-orange-secondary text-white text-[9px] font-black px-4 py-2 rounded-xl shadow-lg shadow-orange-secondary/20 uppercase tracking-widest active:scale-95 transition-all" onclick="sendNudge()">Nudge Her</button>
                </div>
            </div>

            <div class="flex justify-between items-center">
                <h2 class="font-heading text-lg font-bold">My Personal Log</h2>
                <span class="text-[10px] font-black text-gray-400 px-3 py-1 bg-white rounded-full border border-gray-100 uppercase" id="meal-count">0 ITEMS</span>
            </div>
            <div class="space-y-3" id="meal-list">
                <div class="text-center py-10 bg-white/50 rounded-2xl-24 border-2 border-dashed border-gray-200">
                    <p class="text-xs font-black text-gray-400">Log some urban fuel to protect the streak!</p>
                </div>
            </div>
        </main>
    </section>

    <!-- QUICK ADD (MANUAL + SCAN) -->
    <section class="hidden animate-in slide-in-from-right duration-300" id="view-quick-add">
        <header class="p-5 flex flex-col gap-4 bg-white border-b border-gray-100 sticky top-0 z-[60]">
            <div class="flex items-center justify-between">
                <button class="p-2 rounded-full hover:bg-gray-100" onclick="navigate('dashboard')">
                    <span class="material-symbols-outlined">arrow_back_ios_new</span>
                </button>
                <h2 class="font-heading text-xl font-bold">Log Food</h2>
                <div class="w-10"></div>
            </div>
            <div class="flex bg-gray-100 p-1 rounded-2xl">
                <button class="flex-1 py-2 text-xs font-black uppercase tracking-widest rounded-xl transition-all bg-white text-brown-90 shadow-sm" id="mode-manual-btn" onclick="setAddMode('manual')">Manual</button>
                <button class="flex-1 py-2 text-xs font-black uppercase tracking-widest rounded-xl transition-all text-gray-400" id="mode-scan-btn" onclick="setAddMode('scan')">AI Scan</button>
            </div>
        </header>

        <div class="px-5 pt-2 pb-10" id="quick-add-manual">
            <div class="flex gap-2 overflow-x-auto no-scrollbar py-4 mb-2" id="category-tabs"></div>
            <div class="grid grid-cols-2 gap-4" id="food-grid"></div>
        </div>

        <div class="hidden px-5 pt-6 pb-10 space-y-6" id="quick-add-scan">
            <div class="relative bg-black rounded-3xl overflow-hidden aspect-[3/4] shadow-2xl" id="camera-frame">
                <img class="w-full h-full object-cover opacity-60" src="https://images.unsplash.com/photo-1555126634-323283e090fa?w=400&h=600&fit=crop" id="scan-image" alt="Food scan">
                <div class="scan-line hidden" id="scan-anim"></div>
                <div class="absolute inset-0 p-8 flex flex-col justify-between pointer-events-none" id="camera-overlay">
                    <div class="flex justify-between">
                        <div class="w-8 h-8 border-t-2 border-l-2 border-white rounded-tl-lg"></div>
                        <div class="w-8 h-8 border-t-2 border-r-2 border-white rounded-tr-lg"></div>
                    </div>
                    <div class="flex justify-between">
                        <div class="w-8 h-8 border-b-2 border-l-2 border-white rounded-bl-lg"></div>
                        <div class="w-8 h-8 border-b-2 border-r-2 border-white rounded-br-lg"></div>
                    </div>
                </div>
                <div class="absolute bottom-6 left-1/2 -translate-x-1/2 w-full px-8 flex justify-center items-center">
                    <button class="w-16 h-16 rounded-full border-4 border-white flex items-center justify-center active:scale-90 transition-all bg-transparent" id="capture-btn" onclick="startScanning()">
                        <div class="w-12 h-12 bg-white rounded-full"></div>
                    </button>
                    <div class="hidden text-white font-black text-xs uppercase tracking-widest animate-pulse" id="scanning-label">Scanning...</div>
                </div>
            </div>
            <div class="hidden fade-in-up bg-white rounded-2xl-24 p-6 border-2 border-green-primary shadow-xl space-y-4" id="scan-result">
                <div class="flex items-center gap-4">
                    <div class="w-16 h-16 bg-gray-50 rounded-2xl flex items-center justify-center text-4xl">üçú</div>
                    <div class="flex-1">
                        <div class="text-[10px] font-black text-green-primary uppercase tracking-widest mb-1">Detected (98%)</div>
                        <h3 class="font-heading text-lg font-extrabold text-brown-90">Ph·ªü B√≤</h3>
                        <p class="text-[10px] font-bold text-gray-400">450 kcal ‚Ä¢ Medium Portion</p>
                    </div>
                </div>
                <button class="w-full py-4 bg-green-primary text-white font-bold rounded-xl shadow-lg" onclick="logScannedFood()">Log to Dashboard</button>
            </div>
        </div>
    </section>

    <!-- SETTINGS / PARTNER TAB -->
    <section class="hidden animate-in slide-in-from-bottom duration-300" id="view-settings">
        <header class="p-5 bg-white border-b flex items-center gap-4">
            <button class="p-2 rounded-full hover:bg-gray-100" onclick="navigate('dashboard')">
                <span class="material-symbols-outlined">close</span>
            </button>
            <h2 class="font-heading text-xl font-bold">Partnership</h2>
        </header>
        <div class="p-6 space-y-6">
            <div class="bg-white p-6 rounded-2xl-24 shadow-sm border border-gray-100 space-y-4">
                <div class="flex items-center justify-between mb-2">
                    <h3 class="font-bold text-xs text-gray-400 uppercase tracking-widest">Active Streak Partner</h3>
                    <button class="text-[9px] font-black text-purple-tertiary bg-purple-tertiary/10 px-2 py-1 rounded uppercase tracking-widest" onclick="alert('Partner reset disabled for demo')">Change</button>
                </div>
                <div class="flex items-center gap-4 p-4 bg-gray-50 rounded-2xl border border-gray-100">
                    <div class="w-14 h-14 bg-orange-secondary rounded-full flex items-center justify-center font-black text-white text-xl" id="partner-settings-avatar">A</div>
                    <div>
                        <div class="font-bold text-brown-90" id="partner-settings-name">Anh</div>
                        <div class="text-[10px] font-bold text-gray-400">Streak Partner since Dec 12</div>
                    </div>
                </div>
            </div>

            <div class="bg-white p-6 rounded-2xl-24 shadow-sm border border-gray-100 space-y-6">
                <h3 class="font-bold text-xs text-gray-400 uppercase tracking-widest">Profile Control</h3>
                <div class="space-y-3" id="household-members-list"></div>
                <p class="text-[10px] text-center text-gray-400 italic">Switching profiles updates your perspective but keeps the shared streak alive!</p>
            </div>

            <div class="pt-10 border-t border-gray-100 text-center">
                <button class="text-[10px] font-black text-gray-300 hover:text-red-400 flex items-center gap-2 uppercase tracking-widest mx-auto" onclick="clearAllData()">
                    <span class="material-symbols-outlined text-sm">delete_forever</span> Reset Local Data
                </button>
            </div>
        </div>
    </section>
</div>

<!-- PORTION PICKER -->
<div class="fixed inset-0 bg-black/40 z-[200] opacity-0 pointer-events-none transition-opacity duration-300" id="portion-overlay" onclick="closePortionPicker()"></div>
<div class="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-white rounded-t-[2.5rem] z-[201] p-8 bottom-sheet shadow-2xl" id="portion-sheet">
    <div class="w-12 h-1 bg-gray-200 rounded-full mx-auto mb-8"></div>
    <div class="mb-8">
        <h3 class="text-3xl font-heading font-extrabold text-brown-90" id="ps-name-vi">Meal Name</h3>
        <p class="text-[11px] font-black text-gray-400 uppercase tracking-widest mt-1" id="ps-name-en">English Name</p>
    </div>
    <div class="grid grid-cols-3 gap-3 mb-8">
        <button class="flex flex-col items-center gap-2 p-5 rounded-3xl border-2 border-gray-100 hover:border-green-primary transition-all" onclick="selectPortion('S')">
            <span class="text-[10px] font-black">SMALL</span>
            <span class="text-xs font-bold text-green-primary" id="ps-cal-s">0</span>
        </button>
        <button class="flex flex-col items-center gap-2 p-5 rounded-3xl border-2 border-green-primary bg-green-primary/5 transition-all" onclick="selectPortion('M')">
            <span class="text-[10px] font-black">MEDIUM</span>
            <span class="text-xs font-bold text-green-primary" id="ps-cal-m">0</span>
        </button>
        <button class="flex flex-col items-center gap-2 p-5 rounded-3xl border-2 border-gray-100 hover:border-green-primary transition-all" onclick="selectPortion('L')">
            <span class="text-[10px] font-black">LARGE</span>
            <span class="text-xs font-bold text-green-primary" id="ps-cal-l">0</span>
        </button>
    </div>
    <button class="w-full py-2 text-gray-400 text-xs font-black uppercase tracking-widest" onclick="closePortionPicker()">Cancel</button>
</div>

<!-- BOTTOM NAV -->
<nav class="fixed bottom-0 left-0 right-0 max-w-md mx-auto h-20 bg-white/95 backdrop-blur-md border-t border-gray-100 flex items-center justify-around px-12 z-50">
    <button class="flex flex-col items-center gap-1 text-green-primary" id="nav-dashboard" onclick="navigate('dashboard')">
        <span class="material-symbols-outlined text-2xl font-bold">grid_view</span>
        <span class="text-[10px] font-black uppercase tracking-tighter">Stats</span>
    </button>
    <div class="relative -top-10">
        <button class="w-16 h-16 bg-brown-90 text-white rounded-full flex items-center justify-center shadow-xl shadow-brown-90/20 active:scale-90 transition-transform" onclick="navigate('quick-add')">
            <span class="material-symbols-outlined text-4xl">add</span>
        </button>
    </div>
    <button class="flex flex-col items-center gap-1 text-gray-400" id="nav-settings" onclick="navigate('settings')">
        <span class="material-symbols-outlined text-2xl">groups</span>
        <span class="text-[10px] font-black uppercase tracking-tighter">Buddy</span>
    </button>
</nav>

<script type="module" src="/src/main.js"></script>
</body>
</html>
